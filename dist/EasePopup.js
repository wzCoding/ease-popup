var EasePopup;(()=>{"use strict";var e={d:(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{default:()=>b});const o={direction:"top",width:"auto",content:"",placement:"outside",useCache:!1,needArrow:!0,single:!0,contentClick:!0,open:!1,arrowSize:10,targetGap:5,boundryGap:[10,10],theme:"light"},r={popup:[".ease-popup",["display","none"],["position","absolute"],["box-sizing","border-box"],["padding","8px"],["box-shadow","0px 0px 6px rgba(0, 0, 0, 0.2)"],["border-radius","4px"],["border","none"],["outline","none"],["margin","0"]],arrow:[".ease-popup .ease-popup-arrow",["display","block"],["position","absolute"],["background-color"," inherit"],["box-shadow","-1px 1px 1px rgba(0, 0, 0, 0.1)"]],dialog:["dialog[open]",["display","block",!0]]},n={light:{background:"#ffffff",color:"#333333"},dark:{background:"#333333",color:"#ffffff"}},p=["top","top-start","top-end","center","bottom","bottom-start","bottom-end"],i=["left","left-start","left-end","center","right","right-start","right-end"];function s(){return{rootWidth:document.documentElement.clientWidth,rootHeight:document.documentElement.clientHeight}}function l(){const e=[...document.querySelectorAll("*")].map((e=>"auto"!==getComputedStyle(e).zIndex));return e.length>0?Math.max(...e)+1:0}function a(e,t){const o=e.split("-")[t];return o?t>0?"-"+o:o:""}function u(e,t,o,r=0){const{direction:n,arrowSize:s,targetGap:l,boundryGap:c}=o;if(!p.concat(i).includes(n))throw new Error("direction is invalid!");if(r>=4)throw new Error("not enough space!");let d=n;const h=p.includes(d),g=a(d,0),f=a(d,1),y=[{defaults:["left","right"],reset:"top"+f,popupSpace:t.width+l+s/2+c[0]},{defaults:["top","bottom"],reset:"left"+f,popupSpace:t.height+l+s/2+c[1]}];r++;const{defaults:w,reset:m,popupSpace:b}=y[Number(h)],x=w.filter((e=>g===e))[0],S=w.filter((e=>g!==e))[0];return e[x]<b&&(r++,e[S]>=b?d=d.replace(x,S):(r++,o.direction=m,d=u(e,t,o,r=0))),d}function c(e){return Object.prototype.toString.call(e).replace("object ","").match(/\w+/g)[0].toLowerCase()}function d(e){let t;return"string"===c(e)&&(t=document.getElementById(e)||document.getElementsByClassName(e)[0]||document.querySelector(e)),c(e).includes("element")&&(t=e),t}function h(e){let t;if("none"===getComputedStyle(e).getPropertyValue("display")){const o=[{key:"pointer-events",value:"none",origin:getComputedStyle(e).getPropertyValue("pointer-events")},{key:"visibility",value:"hidden",origin:getComputedStyle(e).getPropertyValue("visibility")},{key:"z-index",value:-999,origin:getComputedStyle(e).getPropertyValue("z-index")},{key:"display",value:"block",origin:getComputedStyle(e).getPropertyValue("display")}];for(const t of o)e.style[t.key]=t.value;t=e.getBoundingClientRect();for(const t of o)e.style[t.key]=t.origin}else t=e.getBoundingClientRect();return t}function g(e,t){e=d(e);const{rootWidth:o,rootHeight:r}=s(),{top:n,right:l,bottom:a,left:u,height:c,width:g}=h(e);let f=g;if(t){const{target:r,width:n,direction:s,arrowSize:l,targetGap:a,boundryGap:u}=t;if("auto"===n){if(p.includes(s))f=o-f>=2*u[0]?f:o-2*u[0];else if(i.includes(s)){const e=u[0]+a+l,t=r.left>r.right?r.left:r.right;f=t-f>=e?f:t-e}}else{if(!n||isNaN(n))throw new Error("width is invalid!");f=Number(n)}e.style.setProperty("width",`${f}px`),f=h(e).width}return{top:n,right:o-l,bottom:r-a,left:u,width:f,height:c}}function f(e,t){const o="ease-popup-modal",r=l()+2;let n=document.querySelector(`.${o}`);return!n&&t&&(n=document.createElement("div"),n.className=o,n.style.backgroundColor="rgba(0,0,0,0.1)",n.style.zIndex=r,n.style.position="fixed",n.style.inset="0",document.body.appendChild(n)),n&&(n.style.display=e?"block":"none"),r}function y(e,t){if((e=d(e))||((e=document.createElement("dialog")).show||"function"===c(e.show)||(e=document.createElement("div")),document.body.appendChild(e)),!e.show&&"function"!==c(e.show)){const t={open:{value:!1,writable:!0,configurable:!1},show:{value:function(e){this.open=!0,this.style.display="block",e&&this.style.setProperty("--popup-zIndex",e+1)},writable:!1,configurable:!1},showModal:{value:function(){const e=f(this.open,!0);this.show(e)},writable:!1,configurable:!1},close:{value:function(){this.open=!1,this.style.display="none",f()},writable:!1,configurable:!1}};Object.defineProperties(e,t)}const o="ease-popup";return e.className+=` ${o} ${o}-${document.querySelectorAll(`.${o}`).length}`,t.content&&(e.innerHTML=t.content),e}function w(e){const t=Object.assign({},o,e);return t.needArrow||(t.arrowSize=0),t.theme&&(n[t.theme]?(t.background=n[t.theme].background,t.color=n[t.theme].color):"object"==typeof t.theme&&(t.background=t.theme.background,t.color=t.theme.color)),t}function m(e,t){let o;if(document.getElementById(t))o=document.getElementById(t).sheet;else{const e=document.createElement("style");e.id=t,e.type="text/css",document.getElementsByTagName("head")[0].appendChild(e),window.createPopup||e.appendChild(document.createTextNode("")),o=document.styleSheets[document.styleSheets.length-1]}for(let t=0;t<e.length;t++){let r=e[t],n=r[0];if([...o.rules].filter((e=>e.selectorText===n)).length)break;let p=1,i="";for("[object Array]"===Object.prototype.toString.call(r[1][0])&&(r=r[1],p=0);p<r.length;p++){let e=r[p];i+=`${e[0]}:${e[1]}${e[2]?" !important":""};\n`}o.insertRule?o.insertRule(n+"{"+i+"}",o.cssRules.length):o.addRule(n,i,-1)}}const b=class{constructor(e,t,o={}){const n=function(e){let t,o,r,n=[...e];if(!n.length)throw new Error('at least "target" parameter is required');if(t=function(e){if(!(e=d(e)))throw new Error("target parameter is invalid");return e}(n[0]),1===n.length&&(r=w({}),o=y(o,r)),n.length>=2){const e=n[2]?2:1;r=w("object"===c(n[e])?n[e]:{}),o=y(n[1],r)}return{target:t,popup:o,options:r}}(arguments);this.target=n.target,this.popup=n.popup,this.options=n.options,this.options.open&&(r.popup.display="block"),this.popup.classList.add("ease-popup"),m([r.popup],"ease-popup"),m([r.dialog],"ease-popup"),this.options.useCache&&(this.state=0,this.styles={}),this.update(this.computeStyle())}computeStyle(){if(this.options.useCache){if(console.log("useCache"),this.state>=2)return this.styles;this.state++}const e=g(this.target),t=g(this.popup,{...this.options,target:e}),o=u(e,t,this.options),{popupX:n,arrowX:a}=function(e,t,o){const{rootWidth:r}=s(),{direction:n,targetGap:l,arrowSize:a,boundryGap:u}=o,{left:c,width:d}=e,h={popupX:0,arrowX:0};return p.includes(n)&&(h.popupX=c+d/2-t/2,h.arrowX=t/2-a/2,n.includes("start")?(h.popupX=c,h.arrowX=d/2-a/2):n.includes("end")&&(h.popupX=c+d-t,h.arrowX=t-d/2-a/2),h.popupX<u[0]&&(h.popupX=u[0],h.arrowX=c-u[0]+d/2-a/2),h.popupX+t>r-u[0]&&(h.popupX=r-t-u[0],h.arrowX=c-h.popupX+d/2-a/2)),i.includes(n)&&(n.includes("left")?(h.popupX=c-t-l-a,h.arrowX=t-a/2):n.includes("right")&&(h.popupX=c+d+l+a,h.arrowX=-a/2)),h}(e,t.width,this.options),{popupY:c,arrowY:d}=function(e,t,o){const{rootHeight:r}=s(),{direction:n,targetGap:l,arrowSize:a,boundryGap:u}=o,c={popupY:0,arrowY:0},d=e.height;let h=e.top;return p.includes(n)&&(n.includes("top")?(c.popupY=h-t-l-a,c.arrowY=t-a/2):n.includes("bottom")&&(c.popupY=h+d+l+a,c.arrowY=-a/2)),i.includes(n)&&(e.top<u[1]&&(h=u[1]),e.bottom<u[1]&&(h-=u[1]),c.popupY=h+d/2-t/2,c.arrowY=h-c.popupY+d/2-a/2,n.includes("start")?(c.popupY=h,c.arrowY=d/2-a/2):n.includes("end")&&(c.popupY=h+d-t,c.arrowY=t-d/2-a/2),c.popupY<u[1]&&(c.popupY=u[1],c.arrowY=h-c.popupY+d/2-a/2),c.popupY+t>r-u[1]&&(c.popupY=r-u[1]-t,c.arrowY=h-c.popupY+d/2-a/2)),c}(e,t.height,this.options),h=l()+1,f={top:`${c}px`,left:`${n}px`,width:`${t.width}px`,"background-color":`${this.options.background}`,color:`${this.options.color}`,"z-index":`${h}`};return this.options.needArrow&&(m([r.arrow],"ease-popup"),function(e,t){const o="ease-popup-arrow";let r=e.querySelector(`.${o}`);r||(r=document.createElement("span"),r.classList.add(o),e.appendChild(r));let n=0;const{safeDirection:s,arrowSize:l,arrowX:a,arrowY:u}=t;p.includes(s)&&(n=s.includes("top")?-45:135),i.includes(s)&&(n=s.includes("left")?225:45),r.style.transform=`rotate(${n}deg)`,r.style.top=`${u}px`,r.style.left=`${a}px`,r.style.width=`${l}px`,r.style.height=`${l}px`,r.style.zIndex=e.style.zIndex-1,e.classList.add("arrow")}(this.popup,{safeDirection:o,arrowSize:this.options.arrowSize,arrowX:a,arrowY:d})),this.options.direction=o,f}update(e){for(let t in e)this.popup.style.setProperty(t,e[t]);return this.styles&&(this.styles=e),e}show(){this.update(this.computeStyle()),this.popup.show(),this.options.single&&[...document.getElementsByClassName("ease-popup")].filter((e=>e!==this.popup)).forEach((e=>e.close()))}showModal(){this.popup.showModal()}hide(){this.popup.close()}};EasePopup=t.default})();
//# sourceMappingURL=EasePopup.js.map